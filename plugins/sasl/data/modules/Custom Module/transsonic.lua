
-- defineProperty("db1", globalPropertyf("tu154b2/custom/controlls/debug1"))
-- defineProperty("db2", globalPropertyf("tu154b2/custom/controlls/debug2"))
-- defineProperty("db3", globalPropertyf("tu154b2/custom/controlls/debug3"))
defineProperty("angle", globalPropertyf("sim/flightmodel2/misc/AoA_angle_degrees"))
-- Lift elements
defineProperty("cl_3_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[2]"))
defineProperty("cl_4_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[3]"))
defineProperty("cl_5_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[4]"))
defineProperty("cl_6_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[5]"))
defineProperty("cl_7_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[6]"))
defineProperty("cl_8_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[7]"))
defineProperty("cl_9_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[8]"))
defineProperty("cl_10_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[9]"))

defineProperty("cl_3_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[12]"))
defineProperty("cl_4_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[13]"))
defineProperty("cl_5_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[14]"))
defineProperty("cl_6_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[15]"))
defineProperty("cl_7_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[16]"))
defineProperty("cl_8_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[17]"))
defineProperty("cl_9_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[18]"))
defineProperty("cl_10_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[19]"))

defineProperty("cl_11_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[20]"))
defineProperty("cl_12_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[21]"))
defineProperty("cl_13_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[22]"))
defineProperty("cl_14_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[23]"))
defineProperty("cl_15_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[24]"))
defineProperty("cl_16_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[25]"))
defineProperty("cl_17_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[26]"))
defineProperty("cl_18_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[27]"))

defineProperty("cl_11_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[30]"))
defineProperty("cl_12_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[31]"))
defineProperty("cl_13_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[32]"))
defineProperty("cl_14_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[33]"))
defineProperty("cl_15_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[34]"))
defineProperty("cl_16_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[35]"))
defineProperty("cl_17_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[36]"))
defineProperty("cl_18_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[37]"))

defineProperty("cl_21_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[40]"))
defineProperty("cl_22_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[41]"))
defineProperty("cl_23_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[42]"))
defineProperty("cl_24_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[43]"))
defineProperty("cl_25_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[44]"))
defineProperty("cl_26_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[45]"))
defineProperty("cl_27_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[46]"))
defineProperty("cl_28_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[47]"))

defineProperty("cl_21_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[50]"))
defineProperty("cl_22_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[51]"))
defineProperty("cl_23_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[52]"))
defineProperty("cl_24_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[53]"))
defineProperty("cl_25_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[54]"))
defineProperty("cl_26_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[55]"))
defineProperty("cl_27_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[56]"))
defineProperty("cl_28_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[57]"))
-- Drag elements
defineProperty("cd_3_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[2]"))
defineProperty("cd_4_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[3]"))
defineProperty("cd_5_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[4]"))
defineProperty("cd_6_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[5]"))
defineProperty("cd_7_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[6]"))
defineProperty("cd_8_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[7]"))
defineProperty("cd_9_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[8]"))
defineProperty("cd_10_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[9]"))

defineProperty("cd_3_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[12]"))
defineProperty("cd_4_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[13]"))
defineProperty("cd_5_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[14]"))
defineProperty("cd_6_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[15]"))
defineProperty("cd_7_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[16]"))
defineProperty("cd_8_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[17]"))
defineProperty("cd_9_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[18]"))
defineProperty("cd_10_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[19]"))

defineProperty("cd_11_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[20]"))
defineProperty("cd_12_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[21]"))
defineProperty("cd_13_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[22]"))
defineProperty("cd_14_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[23]"))
defineProperty("cd_15_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[24]"))
defineProperty("cd_16_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[25]"))
defineProperty("cd_17_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[26]"))
defineProperty("cd_18_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[27]"))

defineProperty("cd_11_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[30]"))
defineProperty("cd_12_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[31]"))
defineProperty("cd_13_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[32]"))
defineProperty("cd_14_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[33]"))
defineProperty("cd_15_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[34]"))
defineProperty("cd_16_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[35]"))
defineProperty("cd_17_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[36]"))
defineProperty("cd_18_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[37]"))

defineProperty("cd_21_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[40]"))
defineProperty("cd_22_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[41]"))
defineProperty("cd_23_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[42]"))
defineProperty("cd_24_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[43]"))
defineProperty("cd_25_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[44]"))
defineProperty("cd_26_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[45]"))
defineProperty("cd_27_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[46]"))
defineProperty("cd_28_L", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[47]"))

defineProperty("cd_21_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[50]"))
defineProperty("cd_22_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[51]"))
defineProperty("cd_23_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[52]"))
defineProperty("cd_24_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[53]"))
defineProperty("cd_25_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[54]"))
defineProperty("cd_26_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[55]"))
defineProperty("cd_27_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[56]"))
defineProperty("cd_28_R", globalProperty("sim/flightmodel2/wing/elements/element_cd_addition[57]"))

-- Moment elements
defineProperty("cm_3_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[2]"))
defineProperty("cm_4_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[3]"))
defineProperty("cm_5_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[4]"))
defineProperty("cm_6_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[5]"))
defineProperty("cm_7_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[6]"))
defineProperty("cm_8_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[7]"))
defineProperty("cm_9_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[8]"))
defineProperty("cm_10_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[9]"))

defineProperty("cm_3_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[12]"))
defineProperty("cm_4_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[13]"))
defineProperty("cm_5_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[14]"))
defineProperty("cm_6_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[15]"))
defineProperty("cm_7_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[16]"))
defineProperty("cm_8_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[17]"))
defineProperty("cm_9_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[18]"))
defineProperty("cm_10_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[19]"))

defineProperty("cm_11_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[20]"))
defineProperty("cm_12_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[21]"))
defineProperty("cm_13_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[22]"))
defineProperty("cm_14_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[23]"))
defineProperty("cm_15_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[24]"))
defineProperty("cm_16_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[25]"))
defineProperty("cm_17_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[26]"))
defineProperty("cm_18_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[27]"))

defineProperty("cm_11_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[30]"))
defineProperty("cm_12_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[31]"))
defineProperty("cm_13_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[32]"))
defineProperty("cm_14_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[33]"))
defineProperty("cm_15_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[34]"))
defineProperty("cm_16_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[35]"))
defineProperty("cm_17_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[36]"))
defineProperty("cm_18_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[37]"))

defineProperty("cm_21_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[40]"))
defineProperty("cm_22_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[41]"))
defineProperty("cm_23_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[42]"))
defineProperty("cm_24_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[43]"))
defineProperty("cm_25_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[44]"))
defineProperty("cm_26_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[45]"))
defineProperty("cm_27_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[46]"))
defineProperty("cm_28_L", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[47]"))

defineProperty("cm_21_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[50]"))
defineProperty("cm_22_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[51]"))
defineProperty("cm_23_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[52]"))
defineProperty("cm_24_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[53]"))
defineProperty("cm_25_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[54]"))
defineProperty("cm_26_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[55]"))
defineProperty("cm_27_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[56]"))
defineProperty("cm_28_R", globalProperty("sim/flightmodel2/wing/elements/element_cm_addition[57]"))

-- areas
-- defineProperty("A_3_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[2]"))
-- defineProperty("A_4_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[3]"))
-- defineProperty("A_5_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[4]"))
-- defineProperty("A_6_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[5]"))
-- defineProperty("A_7_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[6]"))
-- defineProperty("A_8_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[7]"))
-- defineProperty("A_9_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[8]"))
-- defineProperty("A_10_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[9]"))

-- defineProperty("A_3_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[12]"))
-- defineProperty("A_4_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[13]"))
-- defineProperty("A_5_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[14]"))
-- defineProperty("A_6_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[15]"))
-- defineProperty("A_7_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[16]"))
-- defineProperty("A_8_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[17]"))
-- defineProperty("A_9_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[18]"))
-- defineProperty("A_10_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[19]"))

-- defineProperty("A_11_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[20]"))
-- defineProperty("A_12_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[21]"))
-- defineProperty("A_13_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[22]"))
-- defineProperty("A_14_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[23]"))
-- defineProperty("A_15_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[24]"))
-- defineProperty("A_16_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[25]"))
-- defineProperty("A_17_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[26]"))
-- defineProperty("A_18_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[27]"))

-- defineProperty("A_11_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[30]"))
-- defineProperty("A_12_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[31]"))
-- defineProperty("A_13_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[32]"))
-- defineProperty("A_14_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[33]"))
-- defineProperty("A_15_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[34]"))
-- defineProperty("A_16_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[35]"))
-- defineProperty("A_17_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[36]"))
-- defineProperty("A_18_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[37]"))

-- defineProperty("A_21_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[40]"))
-- defineProperty("A_22_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[41]"))
-- defineProperty("A_23_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[42]"))
-- defineProperty("A_24_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[43]"))
-- defineProperty("A_25_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[44]"))
-- defineProperty("A_26_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[45]"))
-- defineProperty("A_27_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[46]"))
-- defineProperty("A_28_L", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[47]"))

-- defineProperty("A_21_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[50]"))
-- defineProperty("A_22_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[51]"))
-- defineProperty("A_23_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[52]"))
-- defineProperty("A_24_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[53]"))
-- defineProperty("A_25_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[54]"))
-- defineProperty("A_26_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[55]"))
-- defineProperty("A_27_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[56]"))
-- defineProperty("A_28_R", globalProperty("sim/flightmodel2/wing/elements/element_surface_area_mtr_sq[57]"))
--- Horizontal Stab
defineProperty("cl_stab_1_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[80]"))
defineProperty("cl_stab_2_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[81]"))
defineProperty("cl_stab_3_L", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[82]"))

defineProperty("cl_stab_1_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[90]"))
defineProperty("cl_stab_2_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[91]"))
defineProperty("cl_stab_3_R", globalProperty("sim/flightmodel2/wing/elements/element_cl_addition[92]"))

defineProperty("onground",globalPropertyi("sim/flightmodel/failures/onground_any"))

local lift_corr_tbl = {{ -100000, 0 },    -- bugs walkaround
                  {  0.55, 0 }, 
				  {  0.7, 1 }, --
          	      {  1000000000, 1 }} 

local stab_tbl = {{ -1000, 0 },    -- bugs walkaround
				  {  17, 0 },
				  {  27, 0.6 },
				  {  40, 1 },
				  {  50, 1 },
				  {  70, 0.7 }, 
          	      {  1000, 0 }} 

defineProperty("machno", globalProperty("sim/flightmodel/misc/machno"))

function update()
	local mach=math.min(get(machno)+0.002,0.84)
	local aoa=get(angle)+3
	local lift_add=-3.58740446182243122308e+00 + 1.69496110000432658182e+01*mach -2.95816610321598338906e-01*aoa -2.54403303635845645658e+01*math.pow(mach,2) + 6.77376126077940510228e-01*mach*aoa + 2.05126965468935378023e-02*math.pow(aoa,2) + 1.17834420812583822169e+01*math.pow(mach,3) -1.72767255790202356458e-01*math.pow(mach,2)*aoa -4.09997147461917815781e-02*mach*math.pow(aoa,2) + 1.85861597619942270126e-06*math.pow(aoa,3)
	--1.09285840711019988092e+00 + 5.83372697783003335559e+00*mach -1.50656423425714780517e-01*aoa -9.68643764392536432695e+00*math.pow(mach,2) + 4.39218302322306186625e-01*mach*aoa + 9.46306891008961113820e-03*math.pow(aoa,2) + 4.84982321888581591196e+00*math.pow(mach,3) -1.66351686439048018773e-01*math.pow(mach,2)*aoa -2.32029948335523601710e-02*mach*math.pow(aoa,2)
	lift_add=math.max(0,lift_add)
	lift_add=math.min(0.13,lift_add)*interpolate(lift_corr_tbl,mach)
	if mach<=0.5 or aoa <0 or aoa>12 then
		lift_add=0
	end
	--set(db1,lift_add)
	--local drag_corr_max=7.99999999999999496236e-03 -1.99999999999999934774e-02*mach + 1.93999218051333917640e-19*aoa
	--local drag_corr=1.91396770275400918138e-01 -6.93952932880196438070e-01*mach -3.52161817258651449469e-02*aoa + 7.63551164678726079771e-01*math.pow(mach,2) + 8.60250222130951869293e-02*mach*aoa + 2.22497953711458867562e-03*math.pow(aoa,2) -3.50831073635585855008e-01*math.pow(mach,3) -3.00736430977366596407e-02*math.pow(mach,2)*aoa -3.71871748576133726027e-03*mach*math.pow(aoa,2) -3.08132218250604543236e-05*math.pow(aoa,3)
	mach=get(machno)+0.002
	local drag_add=8.85265158274907149050e-02 -5.06316101389889250406e-01*mach -2.10521697309319216762e-01*lift_add + 9.48528641652999771061e-01*math.pow(mach,2) + 4.15976287357348595286e-01*mach*lift_add + 1.47028219916975566584e+00*math.pow(lift_add,2) -5.79939695222643214478e-01*math.pow(mach,3) + 1.48564522326020270748e-02*math.pow(mach,2)*lift_add -2.95473353008539874054e+00*mach*math.pow(lift_add,2)
	--set(db3,drag_add)
	--drag_add=drag_add
	--1.00068214446934769524e-01 -4.39346790537114617603e-01*mach -1.02962759159825378852e+00*lift_add + 6.43250434410157723164e-01*math.pow(mach,2) + 3.03309740756838985831e+00*mach*lift_add + 1.66687089822351852675e+00*math.pow(lift_add,2) -3.29157435619849059183e-01*math.pow(mach,3) -1.91849352370861270245e+00*math.pow(mach,2)*lift_add -3.47329333415103080895e+00*mach*math.pow(lift_add,2)
	--get(db2)
	--9.56017341984749177697e-03 -3.40699583816165968431e-02*mach -1.02256961118312195147e+00*lift_add + 7.26150392913837705589e-02*math.pow(mach,2) + 2.56002059495598954797e+00*mach*lift_add + 4.24754009467589987992e+00*math.pow(lift_add,2) -8.57693469896983057277e-02*math.pow(mach,3) -1.01015211888524958361e+00*math.pow(mach,2)*lift_add -8.58503829216778946432e+00*mach*math.pow(lift_add,2)
	--math.max(drag_corr_max,drag_corr)
	if mach<=0.5 then
		drag_add=0	
	end
	local stab_cl=-1*interpolate(stab_tbl,aoa)	-- stab looses lift beyond 20 due to main wing slip stream
	aoa=math.min(aoa,50)
	local aoa_drag_add=0.002222*math.pow(aoa-3,2)-0.03667*(aoa-3)+0.15 -- add some drag at high AoA
	if aoa-3<9 then
		aoa_drag_add=0
	end
	drag_add=drag_add*interpolate(lift_corr_tbl,mach)+aoa_drag_add
	
	local moment_add_stall=-2*(-0.0007311*math.pow(aoa,2)+0.03024*aoa-0.3157)-- add moment at high aoa for a somewhat realistic stall behavior
	if aoa<20 then
		moment_add_stall=0
	end
	-- this accounts for backward CoL shift in the transsonic region
	local moment_add_base=-1.00955794504217539753e+01*math.pow(mach,4) + 2.86057347670343808943e+01*math.pow(mach,3) -2.95626941457675513902e+01*math.pow(mach,2) + 1.31373566308281084503e+01*mach -2.12274790920010447692e+00
	if mach<0.5 then
		 moment_add_base=0
	end
	local moment_add=moment_add_stall+moment_add_base
	-- set(db1,lift_add)
	-- set(db2,drag_add)
	if mach>=0.5 then
		set(cl_3_L,lift_add)
		set(cl_4_L,lift_add)
		set(cl_5_L,lift_add)
		set(cl_6_L,lift_add)
		set(cl_7_L,lift_add)
		set(cl_8_L,lift_add)
		set(cl_9_L,lift_add)
		set(cl_10_L,lift_add)

		set(cl_3_R,lift_add)
		set(cl_4_R,lift_add)
		set(cl_5_R,lift_add)
		set(cl_6_R,lift_add)
		set(cl_7_R,lift_add)
		set(cl_8_R,lift_add)
		set(cl_9_R,lift_add)
		set(cl_10_R,lift_add)
		
		set(cl_11_L,lift_add)
		set(cl_12_L,lift_add)
		set(cl_13_L,lift_add)
		set(cl_14_L,lift_add)
		set(cl_15_L,lift_add)
		set(cl_16_L,lift_add)
		set(cl_17_L,lift_add)
		set(cl_18_L,lift_add)
		
		set(cl_11_R,lift_add)
		set(cl_12_R,lift_add)
		set(cl_13_R,lift_add)
		set(cl_14_R,lift_add)
		set(cl_15_R,lift_add)
		set(cl_16_R,lift_add)
		set(cl_17_R,lift_add)
		set(cl_18_R,lift_add)
		
		set(cl_21_L,lift_add)
		set(cl_22_L,lift_add)
		set(cl_23_L,lift_add)
		set(cl_24_L,lift_add)
		set(cl_25_L,lift_add)
		set(cl_26_L,lift_add)
		set(cl_27_L,lift_add)
		set(cl_28_L,lift_add)
		
		set(cl_21_R,lift_add)
		set(cl_22_R,lift_add)
		set(cl_23_R,lift_add)
		set(cl_24_R,lift_add)
		set(cl_25_R,lift_add)
		set(cl_26_R,lift_add)
		set(cl_27_R,lift_add)
		set(cl_28_R,lift_add)
		
		set(cd_3_L,drag_add)
		set(cd_4_L,drag_add)
		set(cd_5_L,drag_add)
		set(cd_6_L,drag_add)
		set(cd_7_L,drag_add)
		set(cd_8_L,drag_add)
		set(cd_9_L,drag_add)
		set(cd_10_L,drag_add)

		set(cd_3_R,drag_add)
		set(cd_4_R,drag_add)
		set(cd_5_R,drag_add)
		set(cd_6_R,drag_add)
		set(cd_7_R,drag_add)
		set(cd_8_R,drag_add)
		set(cd_9_R,drag_add)
		set(cd_10_R,drag_add)
		
		set(cd_11_L,drag_add)
		set(cd_12_L,drag_add)
		set(cd_13_L,drag_add)
		set(cd_14_L,drag_add)
		set(cd_15_L,drag_add)
		set(cd_16_L,drag_add)
		set(cd_17_L,drag_add)
		set(cd_18_L,drag_add)
		
		set(cd_11_R,drag_add)
		set(cd_12_R,drag_add)
		set(cd_13_R,drag_add)
		set(cd_14_R,drag_add)
		set(cd_15_R,drag_add)
		set(cd_16_R,drag_add)
		set(cd_17_R,drag_add)
		set(cd_18_R,drag_add)
		
		set(cd_21_L,drag_add)
		set(cd_22_L,drag_add)
		set(cd_23_L,drag_add)
		set(cd_24_L,drag_add)
		set(cd_25_L,drag_add)
		set(cd_26_L,drag_add)
		set(cd_27_L,drag_add)
		set(cd_28_L,drag_add)
		
		set(cd_21_R,drag_add)
		set(cd_22_R,drag_add)
		set(cd_23_R,drag_add)
		set(cd_24_R,drag_add)
		set(cd_25_R,drag_add)
		set(cd_26_R,drag_add)
		set(cd_27_R,drag_add)
		set(cd_28_R,drag_add)
	end
	set(cl_stab_1_L,stab_cl+1*bool2int(aoa>35 and get(angle)<50))
	set(cl_stab_2_L,stab_cl)
	set(cl_stab_3_L,stab_cl)
	
	set(cl_stab_1_R,stab_cl+1*bool2int(aoa>35 and get(angle)<50))
	set(cl_stab_2_R,stab_cl)
	set(cl_stab_3_R,stab_cl)
	local grnd = get(onground)
	--if mach>=0.5 or (aoa>=20 and grnd==0) then
	set(cm_3_L,moment_add)
	set(cm_4_L,moment_add)
	set(cm_5_L,moment_add)
	set(cm_6_L,moment_add)
	set(cm_7_L,moment_add)
	set(cm_8_L,moment_add)
	set(cm_9_L,moment_add)
	set(cm_10_L,moment_add)

	set(cm_3_R,moment_add)
	set(cm_4_R,moment_add)
	set(cm_5_R,moment_add)
	set(cm_6_R,moment_add)
	set(cm_7_R,moment_add)
	set(cm_8_R,moment_add)
	set(cm_9_R,moment_add)
	set(cm_10_R,moment_add)
	
	set(cm_11_L,moment_add)
	set(cm_12_L,moment_add)
	set(cm_13_L,moment_add)
	set(cm_14_L,moment_add)
	set(cm_15_L,moment_add)
	set(cm_16_L,moment_add)
	set(cm_17_L,moment_add)
	set(cm_18_L,moment_add)
	
	set(cm_11_R,moment_add)
	set(cm_12_R,moment_add)
	set(cm_13_R,moment_add)
	set(cm_14_R,moment_add)
	set(cm_15_R,moment_add)
	set(cm_16_R,moment_add)
	set(cm_17_R,moment_add)
	set(cm_18_R,moment_add)
	
	set(cm_21_L,moment_add)
	set(cm_22_L,moment_add)
	set(cm_23_L,moment_add)
	set(cm_24_L,moment_add)
	set(cm_25_L,moment_add)
	set(cm_26_L,moment_add)
	set(cm_27_L,moment_add)
	set(cm_28_L,moment_add)
	
	set(cm_21_R,moment_add)
	set(cm_22_R,moment_add)
	set(cm_23_R,moment_add)
	set(cm_24_R,moment_add)
	set(cm_25_R,moment_add)
	set(cm_26_R,moment_add)
	set(cm_27_R,moment_add)
	set(cm_28_R,moment_add)	
	-- elseif grnd==1 and get(cm_3_L)~=0 then
		-- set(cm_3_L,0)
		-- set(cm_4_L,0)
		-- set(cm_5_L,0)
		-- set(cm_6_L,0)
		-- set(cm_7_L,0)
		-- set(cm_8_L,0)
		-- set(cm_9_L,0)
		-- set(cm_10_L,0)

		-- set(cm_3_R,0)
		-- set(cm_4_R,0)
		-- set(cm_5_R,0)
		-- set(cm_6_R,0)
		-- set(cm_7_R,0)
		-- set(cm_8_R,0)
		-- set(cm_9_R,0)
		-- set(cm_10_R,0)
		
		-- set(cm_11_L,0)
		-- set(cm_12_L,0)
		-- set(cm_13_L,0)
		-- set(cm_14_L,0)
		-- set(cm_15_L,0)
		-- set(cm_16_L,0)
		-- set(cm_17_L,0)
		-- set(cm_18_L,0)
		
		-- set(cm_11_R,0)
		-- set(cm_12_R,0)
		-- set(cm_13_R,0)
		-- set(cm_14_R,0)
		-- set(cm_15_R,0)
		-- set(cm_16_R,0)
		-- set(cm_17_R,0)
		-- set(cm_18_R,0)

		-- set(cm_21_L,0)
		-- set(cm_22_L,0)
		-- set(cm_23_L,0)
		-- set(cm_24_L,0)
		-- set(cm_25_L,0)
		-- set(cm_26_L,0)
		-- set(cm_27_L,0)
		-- set(cm_28_L,0)

		-- set(cm_21_R,0)
		-- set(cm_22_R,0)
		-- set(cm_23_R,0)
		-- set(cm_24_R,0)
		-- set(cm_25_R,0)
		-- set(cm_26_R,0)
		-- set(cm_27_R,0)
		-- set(cm_28_R,0)	
	-- end
	
	
	
	-- local area=get(A_3_L)+
-- get(A_4_L)+
-- get(A_5_L)+
-- get(A_6_L)+
-- get(A_7_L)+
-- get(A_8_L)+
-- get(A_9_L)+
-- get(A_10_L)+
-- get(A_3_R)+
-- get(A_4_R)+
-- get(A_5_R)+
-- get(A_6_R)+
-- get(A_7_R)+
-- get(A_8_R)+
-- get(A_9_R)+
-- get(A_10_R)+
-- get(A_11_L)+
-- get(A_12_L)+
-- get(A_13_L)+
-- get(A_14_L)+
-- get(A_15_L)+
-- get(A_16_L)+
-- get(A_17_L)+
-- get(A_18_L)+		  
-- get(A_11_R)+
-- get(A_12_R)+
-- get(A_13_R)+
-- get(A_14_R)+
-- get(A_15_R)+
-- get(A_16_R)+
-- get(A_17_R)+
-- get(A_18_R)+		  
-- get(A_21_L)+
-- get(A_22_L)+
-- get(A_23_L)+
-- get(A_24_L)+
-- get(A_25_L)+
-- get(A_26_L)+
-- get(A_27_L)+
-- get(A_28_L)+		  
-- get(A_21_R)+
-- get(A_22_R)+
-- get(A_23_R)+
-- get(A_24_R)+
-- get(A_25_R)+
-- get(A_26_R)+
-- get(A_27_R)+
-- get(A_28_R)
-- set(db3,area)
end
